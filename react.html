<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="description" content="Тестовое задание для Li@iL. React">
    <meta name="Boss Soft" content="">

    <title>React • Li@iL test work.</title>
    <style>
        .indent {
            margin-left: 20px;
        }
    </style>
</head>
<body>
<div id="root"></div>
<script src="https://unpkg.com/react@17/umd/react.development.js"></script>
<script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
<script type="text/babel">
    class Tree extends React.Component {
        render() {
            const { services, head } = this.props;
            const sortedServices = services.filter(service => service.head === head)
                .sort((a, b) => a.sorthead - b.sorthead);

            return (
                <div className="indent">
                    {sortedServices.map(service => (
                        <div key={service.id}>
                            {service.name} {service.price !== 0 && `(${service.price})`}
                            {service.node === 1 && <Tree services={services} head={service.id} />}
                        </div>
                    ))}
                </div>
            );
        }
    }

    class App extends React.Component {
        state = {
            services: [
                {
                    "id": 1,
                    "head": null,
                    "name": "Проф.осмотр",
                    "node": 0,
                    "price": 100.0,
                    "sorthead": 20
                },
                {
                    "id": 2,
                    "head": null,
                    "name": "Хирургия",
                    "node": 1,
                    "price": 0.0,
                    "sorthead": 10
                },
                {
                    "id": 3,
                    "head": 2,
                    "name": "Удаление зубов",
                    "node": 1,
                    "price": 0.0,
                    "sorthead": 10
                },
                {
                    "id": 4,
                    "head": 3,
                    "name": "Удаление зуба",
                    "node": 0,
                    "price": 800.0,
                    "sorthead": 10
                },
                {
                    "id": 5,
                    "head": 3,
                    "name": "Удаление 8ого зуба",
                    "node": 0,
                    "price": 1000.0,
                    "sorthead": 30
                },
                {
                    "id": 6,
                    "head": 3,
                    "name": "Удаление осколка зуба",
                    "node": 0,
                    "price": 2000.0,
                    "sorthead": 20
                },
                {
                    "id": 7,
                    "head": 2,
                    "name": "Хирургические вмешательство",
                    "node": 0,
                    "price": 200.0,
                    "sorthead": 10
                },
                {
                    "id": 8,
                    "head": 2,
                    "name": "Имплантация зубов",
                    "node": 1,
                    "price": 0.0,
                    "sorthead": 20
                },
                {
                    "id": 9,
                    "head": 8,
                    "name": "Коронка",
                    "node": 0,
                    "price": 3000.0,
                    "sorthead": 10
                },
                {
                    "id": 10,
                    "head": 8,
                    "name": "Слепок челюсти",
                    "node": 0,
                    "price": 500.0,
                    "sorthead": 20
                }
            ]
        };

        render() {
            const { services } = this.state;

            return (
                <Tree services={services} head={null} />
            );
        }
    }

    ReactDOM.render(<App />, document.getElementById('root'));
</script>
</body>
</html>
